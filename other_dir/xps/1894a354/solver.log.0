[[36m12-03 23:48:33[0m][[34mdora.distrib[0m][[32mINFO[0m] - world_size is 1, skipping init.[0m
[[36m12-03 23:48:33[0m][[34mflashy.solver[0m][[32mINFO[0m] - Instantiating solver MusicGenSolver for XP 1894a354[0m
[[36m12-03 23:48:33[0m][[34mflashy.solver[0m][[32mINFO[0m] - All XP logs are stored in /home/thomasyim/cs229-music/other_dir/xps/1894a354[0m
[[36m12-03 23:48:33[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split evaluate: /home/thomasyim/cs229-music/content/audiocraft/egs/eval[0m
[[36m12-03 23:48:33[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split generate: /home/thomasyim/cs229-music/content/audiocraft/egs/train[0m
[[36m12-03 23:48:33[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split train: /home/thomasyim/cs229-music/content/audiocraft/egs/train[0m
[[36m12-03 23:48:34[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split valid: /home/thomasyim/cs229-music/content/audiocraft/egs/eval[0m
[[36m12-03 23:48:34[0m][[34mroot[0m][[32mINFO[0m] - Getting pretrained compression model from HF facebook/encodec_32khz[0m
[[36m12-03 23:48:34[0m][[34mflashy.solver[0m][[32mINFO[0m] - Compression model has 4 codebooks with 2048 cardinality, and a framerate of 50[0m
[[36m12-03 23:48:34[0m][[34maudiocraft.modules.conditioners[0m][[32mINFO[0m] - T5 will be evaluated with autocast as float32[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model hash: 84d640e215de7863e944e465549d3e2e5faa07eb[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Initializing EMA on the model with decay = 0.99 every 10 updates[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model size: 420.37 M params[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Base memory usage, with model, grad and optim: 6.73 GB[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Restoring weights and history.[0m
[[36m12-03 23:48:39[0m][[34mflashy.solver[0m][[32mINFO[0m] - Loading a pretrained model. Ignoring 'load_best' and 'ignore_state_keys' params.[0m
[[36m12-03 23:48:40[0m][[34mflashy.solver[0m][[32mINFO[0m] - Checkpoint source is not the current xp: Load state_dict from best state.[0m
[[36m12-03 23:48:40[0m][[34mflashy.solver[0m][[32mINFO[0m] - Ignoring keys when loading best [][0m
[[36m12-03 23:48:40[0m][[34mflashy.solver[0m][[32mINFO[0m] - Loading state_dict from best state.[0m
[[36m12-03 23:48:42[0m][[34mflashy.solver[0m][[32mINFO[0m] - Re-initializing EMA from best state[0m
[[36m12-03 23:48:42[0m][[34mflashy.solver[0m][[32mINFO[0m] - Initializing EMA on the model with decay = 0.99 every 10 updates[0m
[[36m12-03 23:48:44[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model hash: 776d041cbbcb8973c4968782a79f9bb63b53a727[0m
[[36m12-03 23:48:55[0m][[34maudiocraft.modules.codebooks_patterns[0m][[32mINFO[0m] - New pattern, time steps: 1500, sequence steps: 1504[0m
[[36m12-03 23:50:18[0m][[34mflashy.solver[0m][[32mINFO[0m] - Train | Epoch 1 | 100/1000 | 1.21 it/sec | lr 9.55E-05 | grad_norm INF | grad_scale 15816.238 | ce 2.721 | ppl 194.490[0m
[[36m12-03 23:56:03[0m][[34mdora.distrib[0m][[32mINFO[0m] - world_size is 1, skipping init.[0m
[[36m12-03 23:56:03[0m][[34mflashy.solver[0m][[32mINFO[0m] - Instantiating solver MusicGenSolver for XP 1894a354[0m
[[36m12-03 23:56:03[0m][[34mflashy.solver[0m][[32mINFO[0m] - All XP logs are stored in /home/thomasyim/cs229-music/other_dir/xps/1894a354[0m
[[36m12-03 23:56:03[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split evaluate: /home/thomasyim/cs229-music/content/audiocraft/egs/eval[0m
[[36m12-03 23:56:03[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split generate: /home/thomasyim/cs229-music/content/audiocraft/egs/train[0m
[[36m12-03 23:56:04[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split train: /home/thomasyim/cs229-music/content/audiocraft/egs/train[0m
[[36m12-03 23:56:04[0m][[34maudiocraft.solvers.builders[0m][[32mINFO[0m] - Loading audio data split valid: /home/thomasyim/cs229-music/content/audiocraft/egs/eval[0m
[[36m12-03 23:56:04[0m][[34mroot[0m][[32mINFO[0m] - Getting pretrained compression model from HF facebook/encodec_32khz[0m
[[36m12-03 23:56:05[0m][[34mflashy.solver[0m][[32mINFO[0m] - Compression model has 4 codebooks with 2048 cardinality, and a framerate of 50[0m
[[36m12-03 23:56:05[0m][[34maudiocraft.modules.conditioners[0m][[32mINFO[0m] - T5 will be evaluated with autocast as float32[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model hash: 84d640e215de7863e944e465549d3e2e5faa07eb[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Initializing EMA on the model with decay = 0.99 every 10 updates[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model size: 420.37 M params[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Base memory usage, with model, grad and optim: 6.73 GB[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Restoring weights and history.[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Loading a pretrained model. Ignoring 'load_best' and 'ignore_state_keys' params.[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Checkpoint source is not the current xp: Load state_dict from best state.[0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Ignoring keys when loading best [][0m
[[36m12-03 23:56:11[0m][[34mflashy.solver[0m][[32mINFO[0m] - Loading state_dict from best state.[0m
[[36m12-03 23:56:13[0m][[34mflashy.solver[0m][[32mINFO[0m] - Re-initializing EMA from best state[0m
[[36m12-03 23:56:13[0m][[34mflashy.solver[0m][[32mINFO[0m] - Initializing EMA on the model with decay = 0.99 every 10 updates[0m
[[36m12-03 23:56:16[0m][[34mflashy.solver[0m][[32mINFO[0m] - Model hash: 776d041cbbcb8973c4968782a79f9bb63b53a727[0m
[[36m12-03 23:56:28[0m][[34maudiocraft.modules.codebooks_patterns[0m][[32mINFO[0m] - New pattern, time steps: 1500, sequence steps: 1504[0m
[[36m12-03 23:57:51[0m][[34mflashy.solver[0m][[32mINFO[0m] - Train | Epoch 1 | 100/1000 | 1.19 it/sec | lr 9.55E-05 | grad_norm INF | grad_scale 18492.832 | ce 2.537 | ppl 14.500[0m
[[36m12-03 23:59:15[0m][[34mflashy.solver[0m][[32mINFO[0m] - Train | Epoch 1 | 200/1000 | 1.20 it/sec | lr 9.98E-05 | grad_norm 4.639E+00 | grad_scale 16384.000 | ce 2.462 | ppl 12.150[0m
[[36m12-04 00:00:38[0m][[34mflashy.solver[0m][[32mINFO[0m] - Train | Epoch 1 | 300/1000 | 1.20 it/sec | lr 9.94E-05 | grad_norm 2.340E+00 | grad_scale 16384.000 | ce 2.331 | ppl 10.865[0m
